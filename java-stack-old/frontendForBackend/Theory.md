# Back-end for Front-end theory and questions

Back-end for Front-end это паттерн. Он предполагает, что мы используем N-ное кол-во апи гейтвеев, которое разделяет нас по фичам. Gateway для мобильного клиента, для веб клиента. Команда, разрабатывающая мобильный клиент поддерживает свой апи гейтвей, команда веб клиента поддерживает свой. Альтернативный солюшн GraphQL или OData.

## Проблемы при переходе на микросервисы

- Как минимизировать количество запросов на бек?
При монолите мы делали один запрос на эндпоинт и он подготавливал нам один ответ. При микросервисной архитектуре может быть такое, что мы должны собирать данные с нескольких сервисов. Например сервис программ, сервис документов и так далее. Это может сказаться на скорости. Плюс часто запросы являются синхронными, что тоже влияет на скорость выполнения.

- Проблема с секьюрити
Как управлять авторизацией для микросервисов.

- Балансировка
Как управлять? Также вопрос при скейлинге, когда появляются новые инстансы сервисов мы должны тоже обеспечить перевод нагрузки и на них в том числе.

- Управление данными, которые нужны разным клиентам. 
Например, веб приложения могут отображать большие модели данных. Для мобильных приложений нужно отдавать меньшие можели данных (урезанные дто). То есть апи для веб приложения и для мобильного приложения должны быть разными. Потому что у мобильных приложений могут быть проблемы со скоростью интернета, объемом ОЗУ и памяти в целом.

Api для разных клиентов должны быть разными.

## Использование API Gateway

Преимущества:
- Единая точка доступа к апи.
- Уменьшает связанность между клиентом и сервером.
- Освобождает клиент от ненужной ответственности (настройка лоад балансера, логгинга, трейсинга, ретраев и тд).
- Удобная настройка Security.
- Gateway Routing pattern - весь трафик теперь идет через апи гейтвей.
- Cross-cutting concerns (Gateway Offloading pattern) - аутентификация и авторизация, кеширование, ретраи, рейт лимиты, лоад балансинг, логирование, трейсинг, хедеры и тому подобное могут находится в одном месте.

Недостатки: 
- Добавляется дополнительная прослойка, которая увеличивает задержку ответов.
- Single point of failure.

### Gateway Routing pattern

Когда клиенту нужно получать инфу из нескольких сервисов, конфигурировать доступ к каждому из них и управлять запросами к каждому сервису самостоятельно это сложно. Данный паттерн помогает решить эту проблему. Нужно создать апи гейтвей перед нашими сервисами. Тогда клиент будет обращаться только к нему.

Из минусов:
- Single point of failure.
- апи гейтвей может стать ботлнеком (не выдерживать нагрузку).
- увеличивается сложность архитектуры.
- увеличивается время респонса.

### API Gateway типы

Как сервисы: Kong, Nginx, Ambassador. 

Как фреймворк: Spring Cloud Api Gateway, Zuul 2.

## API Composer (Requests aggreagation)

Это паттерн, который знает как мержить респонсы из нескольких сервисов в один общий респонс.
